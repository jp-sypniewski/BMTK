<h1>{{aCompany.name}}</h1>
<h3>{{aCompany.description}}</h3>
<hr>
<h5>Type: {{aCompany.type}}</h5>
<h5>Address: {{aCompany.address}}</h5>
<h5>Phone: {{aCompany.phone}}</h5>
<hr><hr>


<!-- owner relationship, need qual from user -->

<div *ngIf="showEmployees">
  <div *ngIf="aCompany.employees.length > 0">
    <h3>My Employees</h3>
    <table class = "table table-bordered">
      <thead>
        <tr>
          <th>First Name</th>
          <th>Last Name</th>
          <th>Email</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let employee of aCompany.employees">
         <td>{{employee.userDetail.firstName}}</td>
         <td>{{employee.userDetail.lastName}}</td>
         <td>{{employee.userDetail.email}}</td>
        </tr>
      </tbody>
    </table>
    <!-- TODO Fix add employee -->
    <button>Add Employee</button>
  </div>
  <div *ngIf="aCompany.employees.length == 0">
    <h3>No Employees!</h3>
    <!-- TODO Fix add employee -->
    <button>Add Employee</button>
  </div>
  <button (click)="showEmployees = false">Hide Employees</button>
</div>
<div *ngIf="!showEmployees">
  <button (click)="showEmployees = true">Show Employees</button>
</div>

<div *ngIf="projectsForCompany.length > 0">
  <h3>Our Customer's Requests</h3>
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Name</th>
        <th>Customer Email</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let project of projectsForCompany">
        <td (click)="showProjectDetails(project)">{{project.name}}</td>
        <td>{{project.customer.userDetail.email}}</td>
      </tr>
    </tbody>
  </table>
  <hr>

  <!-- show edit project -->

  <div *ngIf="editingProject">
    <form>
      <h3>Edit {{selectedProject.name}}:</h3>
      <label for="name">Name:</label>
      <input type="text" name="name" required [(ngModel)]="editingProject.name"><br>
      <label for="active">Active:</label>
      <input type="checkbox" name="active" required [(ngModel)]="editingProject.active"><br>
      <button (click)="saveEditProject()">Save Edits for {{selectedProject.name}}</button>
    </form>
    <hr>
  </div>

  <!-- single project view with tasks -->

  <div *ngIf="selectedProject != null && !editingProject">
    <h3>Selected Project: {{selectedProject.name}}</h3>

    <button (click)="showEditProject(selectedProject)">Edit {{selectedProject.name}}</button>
    <h3>{{selectedProject.name}} Tasks</h3>
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Task Name</th>
          <th>Task Due Date</th>
          <th>Employee(s)</th>
          <th>Delete Task</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let task of selectedProject.tasks | taskIsActive: true">
          <td (click)="showEditTask(task)">{{task.name}}</td>
          <td>{{task.dueDate}}</td>
          <td>
            <span *ngFor="let emp of task.employees">
              {{emp.userDetail.firstName}} {{emp.userDetail.lastName}} <br>
              <i>{{emp.userDetail.email}}</i>
              <br>
            </span>
          </td>
          <td><button (click)="disableTask(task)">Delete {{task.name}}</button></td>
        </tr>
      </tbody>
    </table>
    <button (click)="showCreateTask()">Add new task to {{selectedProject.name}}</button>
    <hr>
  </div>
  <!-- add/edit task? -->
  <div *ngIf="newTask != null">
    <form>
      <h3 *ngIf="!editingATask">New Task Form:</h3>
      <h3 *ngIf="editingATask">Edit Task Form:</h3>
      <label for="name">Name:</label>
      <input type="text" name="name" required [(ngModel)]="newTask.name"><br>
      <label for="description">Description:</label>
      <input type="type" name="description" [(ngModel)]="newTask.description"><br>
      <label for="dueDate">DueDate:</label>
      <input type="date" name="dueDate" [(ngModel)]="newTask.dueDate"><br>
      <label for="paid">Paid:</label>
      <input type="checkbox" name="paid" [(ngModel)]="newTask.paid"><br>
      <label for="startDate">Start Date:</label>
      <input type="date" name="startDate" [(ngModel)]="newTask.startDate"><br>
      <label for="completeDate">Complete Date:</label>
      <input type="date" name="completeDate" [(ngModel)]="newTask.completeDate"><br>
      <label for="status">Status:</label>
      <select name="status" [(ngModel)]="newTask.status">
        <option value="NOTASSIGNED">Not Assigned</option>
        <option value="ASSIGNED">Assigned</option>
        <option value="INPROGRESS">In Progress</option>
        <option value="COMPLETE">Complete</option>
      </select><br>
      <!-- no idea if this will work...need to test with multiple employees and add multiselect? -->
      <span *ngIf="aCompany.employees.length > 0">
        <label for="employees">Assigned Employees:</label>
        <select name="employees" [(ngModel)]="newTask.employees">
            <option *ngFor="let employee of aCompany.employees" value="{{employee}}">{{employee.userDetail.firstName}} {{employee.userDetail.lastName}}</option>
        </select><br>
      </span>
      <!-- end of the (probably) bad idea -->
      <label for="type">Type:</label>
      <input type="text" name="type" [(ngModel)]="newTask.type"><br>
      <label for="priority">Priority:</label>
      <input type="text" name="priority" [(ngModel)]="newTask.priority"><br>
      <label for="paymentDetails">Payment Details:</label>
      <input type="text" name="paymentDetails" [(ngModel)]="newTask.paymentDetails"><br>
      <label for="price">Price:</label>
      <input type="number" step="0.01" name="price" [(ngModel)]="newTask.price"><br>
      <button *ngIf="!editingATask" (click)="saveNewTask()">Create New Task</button>
      <button *ngIf="editingATask" (click)="saveEditTask()">Save Task</button>
    </form>
    <hr>
  </div>
</div>

<!-- emp relationship, need qual from user -->

<div *ngIf="empTasksToDo.length > 0">
  <h3>My Tasks To Do</h3>
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Task Name</th>
        <th>Task Due Date</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let task of empTasksToDo">
        <td>{{task.name}}</td>
        <td>{{task.dueDate}}</td>
      </tr>
    </tbody>
  </table>
  <hr>
  <!-- edit single task -->

</div>

<!-- customer relationship, need qual from user -->

<div>
  <div *ngIf="projectsRequested.length > 0">
    <h3>Projects Requested</h3>
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Name</th>
          <th>Customer Email</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let project of projectsRequested">
          <td>{{project.name}}</td>
          <td>{{project.customer.userDetail.email}}</td>
        </tr>
      </tbody>
    </table>
  </div>
  <hr>
  <div>
    <button (click)="showRequestNewProject()">Request new project</button>
  </div>
  <hr>
  <!-- request new project -->
  <div *ngIf="newProject != null">
    <form>
      <h3>Request New Project:</h3>
      <label for="name">Name:</label>
      <input type="text" name="name" required [(ngModel)]="newProject.name"><br><br>
      <button (click)="saveRequestNewProject()">Request Project</button>
    </form>
  </div>

</div>
